# AI辅助阅读书籍网站搭建方案

## 一、项目概述

### 1.1 项目定位
个人使用的AI辅助精读阅读工具，基于DeepSeek模型提供智能阅读辅助功能。

### 1.2 技术栈
- **前端框架**：React / Next.js（推荐Next.js，便于Vercel部署）
- **AI模型**：DeepSeek API
- **API密钥**：sk-c0ccad5e135c483abee13bf0755eca16
- **部署平台**：Vercel
- **文件处理**：支持txt、word、pdf等格式解析
- **数据存储**：本地存储（localStorage/IndexedDB）或后端数据库

## 二、页面结构

### 2.1 页面总览
网站共包含以下页面：
1. **书架页面**（主页面）
2. **AI书记页面**（AI对话记录页面）
3. **阅读页面**（全局阅读界面）

### 2.2 页面切换逻辑
- 书架页面 ↔ AI书记页面：通过导航切换
- 书架页面 → 阅读页面：点击书籍卡片进入
- AI书记页面 → 阅读页面：通过书籍卡片进入（需确认交互方式）

## 三、书架页面功能详述

### 3.1 页面布局
- 书籍卡片网格布局
- 每个卡片显示：书籍封面、书名
- 布局样式简洁统一

### 3.2 核心功能

#### 3.2.1 导入书籍功能
- **支持格式**：txt、doc/docx、pdf
- **导入流程**：
  1. 点击导入按钮
  2. 选择电子书文件
  3. 弹出导入配置弹窗：
     - 自定义书籍名称（默认使用文件名）
     - 上传封面图片（可选，支持图片上传）
  4. 点击确认后开始导入
  5. 自动解析电子书目录结构
  6. 显示导入进度
  7. 导入成功/失败提示（Toast提示）

#### 3.2.2 搜索功能
- 搜索框位于页面顶部
- 根据书名进行实时搜索
- 搜索结果高亮显示匹配关键词
- 无结果时显示提示信息

#### 3.2.3 书籍操作
- 点击书籍卡片：进入阅读页面
- 长按/右键菜单：删除书籍（可选功能）

## 四、AI书记页面功能详述

### 4.1 页面布局
- 布局样式与书架页面一致
- 书籍卡片显示：封面、书名 + **"AI+"**蓝色字样标识

### 4.2 核心功能

#### 4.2.1 书籍卡片
- 点击卡片：进入该书籍的AI对话记录页面

#### 4.2.2 AI对话记录页面
- **页面类型**：全局独立页面
- **布局**：标准AI对话界面
  - 左侧：AI回复（系统消息）
  - 右侧：用户消息
  - 底部：聊天输入框

#### 4.2.3 对话记录显示规则
- 上下滚动查看全部历史记录
- 引用书籍原文的格式：
  ```
  OT：xxx（引用的书籍原文内容）
  
  （空一行）
  
  用户提问内容
  ```
- 普通对话：直接显示用户提问和AI回复

#### 4.2.4 功能按钮
- **导出为Excel**：
  - 位置：原"Q-BOOK"和"Q-TOC"按钮位置
  - 点击后弹出确认对话框
  - Excel格式：
    - 表头：OT（原文引用）、Q（用户提问）、A（AI回复）
    - 每行代表一轮问答
    - OT字段可能为空，Q和A一定不为空
- **导出为PDF**：
  - 位置：与"导出为Excel"并列
  - 点击后弹出确认对话框
  - 导出所有聊天记录为PDF文件

#### 4.2.5 实时对话功能
- 支持在记录页面继续与AI对话
- 新对话实时保存到该书籍的对话记录中

#### 4.2.6 心得帖功能
- **按钮样式**：小书信图标按钮
- **位置**：可自由拖动，默认位置遵循黄金比例
- **功能**：
  - 点击弹出"心得帖"浮窗
  - 浮窗特性：
    - 可自由拖动位置
    - 可调整大小（拖拽边缘）
    - 支持自由文字编辑
    - 实时自动保存
    - 手动保存按钮
    - "导出为TXT"按钮（点击后确认导出）
  - 数据存储：每本书独立存储，互不影响

## 五、阅读页面功能详述

### 5.1 页面特性
- **页面类型**：全局独立页面
- **进入方式**：从书架页面点击书籍卡片进入

### 5.2 阅读基础功能

#### 5.2.1 阅读背景与字体
- **背景颜色选项**：
  - 明黄色
  - 白色
  - 漆黑色
- **字体颜色规则**：
  - 明黄色/白色背景 → 黑色字体
  - 漆黑色背景 → 白色字体

#### 5.2.2 翻页方式
- **上下滑动翻页**：垂直滚动翻页
- **左右平滑翻页**：左右滑动切换页面（平滑动画效果）
- 两种方式可通过设置切换

#### 5.2.3 书籍目录
- 显示书籍章节目录
- 点击目录项跳转到对应章节

### 5.3 AI辅助阅读功能

#### 5.3.1 功能开关
- 默认关闭状态
- 开启后页面布局发生变化

#### 5.3.2 布局模式（三种）

**模式一：两页式/双栏式布局（左右布局）**
- 中间虚线分界线
- 分界线可左右拖动调整比例
- 默认左右比例1:1
- 默认：左栏=阅读，右栏=AI对话
- 可切换：左栏=AI对话，右栏=阅读
- 切换按钮位于布局控制区

**模式二：上下栏布局**
- 中间分界线（水平）
- 分界线可上下拖动调整比例
- 默认：上栏=阅读，下栏=AI对话
- 默认比例：黄金比例（阅读上栏占大比例，约61.8%）
- 可切换：上栏=AI对话，下栏=阅读

**模式三：全局阅读模式（上下栏布局的变体）**
- 与模式二相同，但强调全局阅读体验
- 默认上栏阅读，下栏AI对话
- 黄金比例分配

#### 5.3.3 阅读栏与AI对话栏独立设置
- 阅读栏和AI对话栏的背景颜色可独立选择
- 颜色选项相同：明黄色、白色、漆黑色
- 字体颜色遵循相同规则（根据背景色自动调整）

### 5.4 AI对话栏功能

#### 5.4.1 基础对话
- 使用DeepSeek API
- 标准聊天界面：输入框 + 发送按钮
- 对话记录实时保存

#### 5.4.2 Q-BOOK功能
- **按钮位置**：类似通用AI聊天页面的"深度思考"按钮布局
- **按钮名称**："Q-BOOK"
- **功能说明**：
  - 开启后，可在阅读栏长按拖动选中任意文本
  - 选中文本背景变蓝（如荧光笔效果），文字清晰可见
  - 选中的文本作为引用内容
  - 在AI对话栏输入问题后点击发送
  - 发送时自动将选中的引用文本一并发送给DeepSeek
  - 发送后阅读栏选中状态自动取消
  - AI返回结果完整显示在对话页面
- **关闭状态**：无法进行阅读栏文本引用

#### 5.4.3 Q-TOC功能
- **按钮位置**：与"Q-BOOK"按钮并列
- **按钮名称**："Q-TOC"
- **功能说明**：
  - 点击后弹出章节索引目录弹窗
  - 弹窗显示书籍全部章节列表
  - 支持单选或多选章节
  - 选择后点击确定
  - 选中的章节全部内容作为引用
  - 在AI对话栏输入问题后点击发送
  - 发送时自动将选中的章节内容一并发送给DeepSeek
  - AI返回结果完整显示在对话页面

#### 5.4.4 对话记录存储格式
- 有引用时存储格式：
  ```
  OT：xxx（引用的书籍原文）
  
  用户提问内容
  ```
- 无引用时：仅存储用户提问和AI回复

### 5.5 心得帖功能
- **按钮样式**：小书信图标按钮
- **位置**：可自由拖动，默认位置遵循黄金比例
- **功能**：与AI书记页面中的心得帖功能完全相同
- **数据存储**：与AI书记页面共享同一本书的心得帖数据

## 六、数据存储方案

### 6.1 书籍数据
- 书籍基本信息（书名、封面、文件路径）
- 书籍内容（解析后的文本内容）
- 书籍目录结构

### 6.2 AI对话记录
- 按书籍分类存储
- 存储格式：
  - OT（原文引用，可选）
  - Q（用户提问）
  - A（AI回复）
  - 时间戳

### 6.3 心得帖数据
- 按书籍分类存储
- 存储内容：文字内容、时间戳

### 6.4 用户设置
- 阅读背景颜色偏好
- 翻页方式偏好
- AI辅助阅读布局偏好
- 分栏比例设置

## 七、技术实现要点

### 7.1 文件解析
- **TXT**：直接读取文本内容
- **Word**：使用mammoth.js或docx库解析
- **PDF**：使用pdf.js或pdf-parse库解析
- **目录提取**：根据文件格式解析目录结构（标题层级、书签等）

### 7.2 DeepSeek API集成
- API端点：DeepSeek API
- API密钥：sk-c0ccad5e135c483abee13bf0755eca16
- 请求格式：按照DeepSeek API文档格式
- 错误处理：网络错误、API错误等

### 7.3 文本选中与引用
- 使用浏览器Selection API实现文本选中
- 选中文本高亮显示（CSS样式）
- 选中文本内容提取与存储

### 7.4 布局调整
- 使用ResizeObserver或拖拽库实现分界线拖动
- 实时计算并应用布局比例
- 保存用户自定义比例

### 7.5 导出功能
- **Excel导出**：使用xlsx或exceljs库
- **PDF导出**：使用jsPDF或pdfmake库
- **TXT导出**：直接生成文本文件下载

### 7.6 数据持久化
- 前端存储：localStorage（小数据）或IndexedDB（大数据）
- 或使用后端API + 数据库（如需要）

## 八、UI/UX设计要点

### 8.1 设计风格
- 简洁、现代
- 注重阅读体验
- 色彩搭配舒适

### 8.2 交互反馈
- 所有操作都有明确的反馈（成功/失败提示）
- 加载状态显示
- 平滑的动画过渡

### 8.3 响应式设计
- 适配不同屏幕尺寸
- 移动端友好（如需要）

## 九、部署方案

### 9.1 Vercel部署
- 使用Next.js框架便于Vercel部署
- 环境变量配置（API密钥等）
- 静态资源处理

### 9.2 数据存储考虑
- 如果使用前端存储，数据仅存在本地
- 如需跨设备同步，考虑后端存储方案

## 十、开发优先级

### 第一阶段：基础功能
1. 书架页面（导入、搜索、显示）
2. 阅读页面（基础阅读功能）
3. 书籍解析（txt、word、pdf）

### 第二阶段：AI功能
1. AI对话基础功能
2. Q-BOOK功能
3. Q-TOC功能
4. 对话记录存储

### 第三阶段：高级功能
1. AI书记页面
2. 导出功能（Excel、PDF、TXT）
3. 心得帖功能
4. 布局切换与调整

### 第四阶段：优化与完善
1. UI/UX优化
2. 性能优化
3. 错误处理完善
4. 测试与调试

---

## 确认事项

请确认以下内容是否符合您的需求：

1. ✅ 页面结构：书架页面、AI书记页面、阅读页面
2. ✅ 导入功能：支持txt、word、pdf，可自定义书名和封面
3. ✅ 阅读功能：三种背景色、两种翻页方式
4. ✅ AI辅助阅读：三种布局模式，Q-BOOK和Q-TOC功能
5. ✅ AI书记页面：查看对话记录、导出功能
6. ✅ 心得帖功能：可拖动、可编辑、可导出
7. ✅ 数据存储：按书籍分类存储对话记录和心得帖

如有需要调整或补充的地方，请告知，确认后开始代码开发。




